# MaixPy 预训练人脸识别系统

## 🎯 项目概述

这是一个基于MaixHub预训练模型的人脸识别系统，专门设计用于MaixCAM设备。系统可以实时识别10位知名人物。

### 🎭 支持识别的人物
- **胡歌** (huge)
- **姜文** (jiangwen) 
- **彭于晏** (pengyuyan)
- **岳云鹏** (yueyunpeng)
- **周冬雨** (zhoudongyu)
- **迪丽热巴** (dilireba)
- **范冰冰** (fanbingbing)
- **姚明** (yaoming)
- **刘亦菲** (liuyifei)
- **周杰伦** (zhoujielun)

## 📁 项目结构

```
pretrained_face_recognition/
├── main.py                           # 主程序入口
├── models/                           # 模型文件目录
│   ├── model-38558.kmodel           # KPU预训练模型
│   ├── main.py                      # 原始示例代码
│   └── report.json                  # 模型性能报告
├── src/                             # 源代码目录
│   ├── hardware/                    # 硬件控制模块
│   │   ├── button/                  # 虚拟按钮
│   │   └── camera/                  # 摄像头控制
│   └── vision/                      # 视觉处理模块
│       └── recognition/             # 人脸识别
│           └── pretrained_recognizer.py
└── README.md                        # 本文档
```

## 🚀 快速开始

### 在MaixCAM设备上运行

1. **上传项目文件**
   - 将整个 `pretrained_face_recognition` 文件夹上传到MaixCAM
   - 确保模型文件 `models/model-38558.kmodel` 存在

2. **运行程序**
   ```bash
   python main.py
   ```

3. **操作说明**
   - **EXIT按钮**: 退出程序
   - **DEBUG按钮**: 显示系统调试信息
   - **THRESHOLD按钮**: 循环调整置信度阈值

### 在开发环境测试

```bash
# 模拟运行（不需要MaixPy）
python main.py
```

## 🔧 技术特性

### 核心功能
- ✅ **实时人脸识别**: 基于KPU硬件加速
- ✅ **预训练模型**: 无需自己训练，直接使用
- ✅ **10人识别**: 支持10位知名人物
- ✅ **动态阈值**: 可调整识别置信度
- ✅ **触摸界面**: 直观的按钮操作

### 性能指标
- **模型大小**: ~870KB
- **输入尺寸**: 224×224×3
- **推理时间**: ~10-50ms
- **帧率**: 15-25 FPS

## 📊 使用说明

### 界面说明
- **顶部**: 显示版本信息和FPS
- **中部**: 显示识别结果和置信度
- **底部**: 虚拟按钮区域

### 识别逻辑
1. 系统实时捕获摄像头图像
2. 图像缩放到224×224尺寸
3. KPU模型进行推理
4. 输出10个类别的置信度分数
5. 选择最高置信度的结果
6. 与阈值比较决定是否识别成功

### 调试功能
按下DEBUG按钮可查看:
- 系统版本和状态
- 帧率和性能信息
- 识别器加载状态
- 最后识别结果

## 🛠️ 开发指南

### 自定义置信度阈值
```python
# 在代码中修改
recognizer.set_confidence_threshold(0.7)  # 0.0-1.0
```

### 扩展新功能
1. 在 `src/` 目录下添加新模块
2. 在 `main.py` 中集成新功能
3. 更新UI绘制逻辑

### 替换模型
1. 替换 `models/model-38558.kmodel`
2. 更新 `pretrained_recognizer.py` 中的标签列表
3. 调整输入尺寸等参数

## 🐛 故障排除

### 常见问题

1. **模型加载失败**
   ```
   ❌ 模型文件不存在: models/model-38558.kmodel
   ```
   - 确保模型文件路径正确
   - 检查文件是否完整

2. **KPU模块不可用**
   ```
   ❌ KPU模块不可用，尝试使用maix.nn
   ```
   - 确保在MaixCAM设备上运行
   - 检查MaixPy版本兼容性

3. **识别率低**
   - 调整置信度阈值
   - 确保光照充足
   - 保持人脸清晰可见

## 📝 版本历史

### v6.1.0-clean (2025-09-21)
- ✅ 创建独立的项目目录结构
- ✅ 简化代码架构，提高可维护性
- ✅ 优化模块导入和错误处理
- ✅ 完善文档和使用说明

## 🤝 贡献

欢迎提交Issue和Pull Request！

## 📄 许可证

基于原项目许可证开源。
